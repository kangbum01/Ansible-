---
- name: 사용자 정의 팩트를 사용한 웹 서버 설정
  hosts: webserver
  gather_facts: true
  tasks:
  ################################################
  # 1) 패키지 설치
  # 2) 서비스 기동
  # 3) 서비스 설정 <- 이건 스킵
  # 4) 방화벽 등록
  ###############################################
  - name: 1) 패키지 설치 - {{ ansible_local.custom.general.package }}
    ansible.builtin.dnf:
      name: "{{ ansible_local.custom.general.package }}"
      state: present
  
  - name: 2) 서비스 기동 - {{ ansible_local.custom.general.service }}
    ansible.builtin.service:
      name: "{{ ansible_local.custom.general.service }}"
      state: "{{ ansible_local.custom.general.state }}"
      enabled: true
  
  - name: 4) 방화벽 등록 - {{ ansible_local.custom.general.fwsvc }} 
    ansible.posix.firewalld:
      service: "{{ ansible_local.custom.general.fwsvc }}"
      permanent: true
      immediate: true
      state: enabled
  
